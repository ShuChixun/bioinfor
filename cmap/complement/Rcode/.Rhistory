####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
file_name = "../../data/cmap_instances_02.xls"
SampleInfoFile = read_excel(file_name,sheet=1,range='A1:O6101')
###install.packages("readxl")
library(readxl)
###install.packages("readxl")
library(readxl)
file_name = "../../data/cmap_instances_02.xls"
SampleInfoFile = read_excel(file_name,sheet=1,range='A1:O6101')
####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
load('../../data/MergingSet.RData')
View(MergingSet)
View(MergingSet@assayData[["exprs"]])
View(MergingSet)
load('../../data/MergingSet.RData')
load('../../data/CMap.RData')
View(ds)
View(MergingSet@assayData)
MergingSet@assayData[["exprs"]]
Ms <- MergingSet@assayData[["exprs"]]
View(Ms)
save(Ms, file='../../data/Ms.RData')
####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
load('../../data/Ms.RData')
####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
? RankMerging
load('../../data/MergingSet.RData')
# 22min cost too much time
# load('../../data/MergingSet.RData')
# save(MergingSet,file = '../../data/MergingSet.RData')
load('../../data/Ms.RData')
library("cmapR")
library("argparser")
library("GeneExpressionSignature")
library('SummarizedExperiment')
? RankMerging
####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
library("cmapR")
library("argparser")
library("GeneExpressionSignature")
library('SummarizedExperiment')
ï¼Ÿ ScoreGSEA
? ScoreGSEA
####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
# 22min cost too much time
# load('../../data/MergingSet.RData')
# save(MergingSet,file = '../../data/MergingSet.RData')
load('../../data/Ms.RData')
View(Ms)
####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
library("cmapR")
library("argparser")
library("GeneExpressionSignature")
library('SummarizedExperiment')
###install.packages("readxl")
library(readxl)
# 22min cost too much time
# load('../../data/MergingSet.RData')
# save(MergingSet,file = '../../data/MergingSet.RData')
load('../../data/Ms.RData')
View(Ms)
? ScoreGSEA
####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
# 22min cost too much time
# load('../../data/MergingSet.RData')
# save(MergingSet,file = '../../data/MergingSet.RData')
load('../../data/Ms.RData')
View(Ms)
s1 <- Ms['metformin', 1:2]
s1 <- Ms['metformin', 1]
s1 <- Ms['metformin']
s1 <- Ms[1]
s1 <- Ms[1:3]
load('../../data/CMap.RData')
View(ds)
s1[:]
s1<-Ms[:]
s1<-Ms[,]
s1<-Ms[1,]
s1<-Ms[,1]
s1<-Ms[,2]
s1<-Ms[1,3]
s1<-Ms[:,3]
s1<-Ms[1:22283,1]
s1<-Ms[1:22283,2]
s1<-Ms[1:22283]
s1<-Ms['phenformin'][1:22283]
s1<-Ms['phenformin']
s1<-Ms[1:22283]
s2 <- Ms[1:2]
s2 <- Ms[2]
s2 <- Ms['1007_s_at']
dim(Ms)
Ms[1,2]
Ms[1,2:3]
Ms[1:2,2:3]
Ms[1:22,2]
s2 <- Ms[1:22283,2]
s2
s2 <- Ms[1:250,2]
s2
kk <- ks.test(s1, s2)
View(kk)
s3 <- Ms[22283-250:22283,2]
s3
s3 <- Ms[(22283-250):22283,2]
s3
ss <- ks.test(s1, s3)
View(ss)
1- (kk - ss)/2
1- (kk$statistic - ss$statistic)/2
View(ds)
s4<-Ms[,2]
s4<-Ms[1:2,2]
s4<-Ms[1:22283,2]
s4<-Ms[1:2,2]
s4
s4<-Ms[1:3,2]
s4<-Ms[1:22283,2]
s4
s5 = s1[1:250]
s3 <- s3[2,]
s3 <- s3[2:]
s3 <- s3[2:251]
s6 <- s4[(22283-249):22283]
s4[22283]
s6[250]
kk[1] <- ks.test(s1,s2)
kk <- ks.test(s1,s2)
k <- ks.test(s4,s5)
View(k)
s <- ks.test(s4,s6)
View(s)
v1 <- 1 - (kk-ss)/2
v1 <- 1 - (kk$statistic-ss$statistic)/2
v2 <- 1 - (k$statistic-s$statistic)/2
v <- (V1+V2)/2
v <- (v1+v2)/2
v1
v2
v
####calculating CMAP function similarity between drugs (R software)
rm(list=ls())
rm(list=ls())
options(warn = -1)
source("CODE/CONNECTION_SCORES_library.R")
source("CODE/ITERATIVE_CMAPPING_library.R")
